-- –ø—Ä–∏–º–µ—Ä—ã: –±–∏–Ω–∞—Ä–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è + –ø–æ—Ä–æ–∂–¥–µ–Ω–∏–µ –º–Ω-–≤–∞ –±–∏–Ω–∞—Ä–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π
-- TODO: –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∫–∞–∫ –±–∏–Ω–∞—Ä–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ
{-# OPTIONS --cubical --warning=noUnsupportedIndexedMatch #-}
{-# OPTIONS --guardedness #-}

open import Cubical.Foundations.Prelude
open import Cubical.Foundations.HLevels

module ExampleBinaryRel {‚Ñì : Level} (hX : hSet ‚Ñì) where

open import Cubical.Foundations.Powerset using (‚Ñô; _‚àà_)
open import Cubical.Foundations.Function using (curry; uncurry)
open import Cubical.Foundations.Structure using (‚ü®_‚ü©)
open import Cubical.Data.FinData using (Fin; zero; suc; one; two; three; four; five; to‚Ñï)
open import Cubical.Data.Sigma using (_√ó_; _,_; ‚àÉ; ‚àÉ-syntax)
open import Cubical.Data.Vec using (Vec; _‚à∑_; []; lookup) 
open import Cubical.HITs.PropositionalTruncation using (squash‚ÇÅ) 

open import Base

--== –¢–µ–æ—Ä–∏–∏ –±–∏–Ω–∞—Ä–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π ==--

open –†–æ–¥–°—Ç—Ä—É–∫—Ç—É—Ä—ã (hX ‚à∑ []) 

X = ‚ü® hX ‚ü©
S = –°—Ç—É–ø–µ–Ω—å (ùîÖ (ùîá (base zero ‚à∑ base zero ‚à∑ [])))

_ : S ‚â° ‚Ñô (X √ó X)
_ = refl

-- –†–∞–∑–ª–∏—á–Ω—ã–µ –±–∏–Ω–∞—Ä–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è —è–≤–ª—è—é—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ S.


--== –ø–æ—Ä–æ–∂–¥–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ä–µ—Ñ–ª–µ–∫—Å–∏–≤–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π ==--

-- –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ–ø–µ—Ä–∞—Ü–∏–µ–π ‚ÜíùîÖ, –Ω–æ —Å–¥–µ–ª–∞–µ–º –∏–Ω–∞—á–µ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏.

-- –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º PropRel, –æ—Ç–ª–∏—á–Ω—ã–π –æ—Ç –±–∏–±–ª–∏–æ—Ç–µ—á–Ω–æ–≥–æ
PropRel : ‚àÄ {‚ÑìX ‚ÑìY} (X : Type ‚ÑìX) (Y : Type ‚ÑìY) (‚Ñì : Level) ‚Üí Type _
PropRel X Y ‚Ñì = X ‚Üí Y ‚Üí hProp ‚Ñì

-- —É—Å–ª–æ–≤–∏–µ —Ä–µ—Ñ–ª–µ–∫—Å–∏–≤–Ω–æ—Å—Ç–∏ –¥–ª—è –æ—Ç–Ω–æ—à–µ–Ω–∏—è
IsRefl : ‚àÄ {‚Ñì ‚Ñì'} {X : Type ‚Ñì} (R : PropRel X X ‚Ñì') ‚Üí Type _
IsRefl R = ‚àÄ x ‚Üí fst (R x x)

-- —É—Å–ª–æ–≤–∏–µ —Ä–µ—Ñ–ª–µ–∫—Å–∏–≤–Ω–æ—Å—Ç–∏ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–∞—Ä (uncurry)
IsRefl√ó : ‚àÄ {‚Ñì} {X : Type ‚Ñì} (R√ó : ‚Ñô (X √ó X)) ‚Üí hProp _
IsRefl√ó {‚Ñì} {X} R√ó = (‚àÉ[ R ‚àà PropRel X X ‚Ñì ] (IsRefl R) √ó (R√ó ‚â° uncurry R))
                   , squash‚ÇÅ

-- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ä–µ—Ñ–ª–µ–∫—Å–∏–≤–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π (—ç–ª–µ–º–µ–Ω—Ç –Ω—É–∂–Ω–æ–π —Å—Ç—É–ø–µ–Ω–∏)
-- —Ä–∞–≤–µ–Ω —É—Å–ª–æ–≤–∏—é —Ä–µ—Ñ–ª–µ–∫—Å–∏–≤–Ω–æ—Å—Ç–∏! –ß—Ç–æ –Ω–µ—É–¥–∏–≤–∏—Ç–µ–ª—å–Ω–æ, –ø–æ—Å–∫–æ–ª—å–∫—É
-- —Ç–æ –∏ –¥—Ä—É–≥–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –ø—Ä–µ–¥–∏–∫–∞—Ç.
s : ‚àÄ {Sh : –°—Ö–µ–º–∞–°—Ç—É–ø–µ–Ω–∏ 1} ‚Üí –°—Ç—É–ø–µ–Ω—å (ùîÖ (ùîÖ (ùîá (Sh ‚à∑ Sh ‚à∑ []))))
s = IsRefl√ó 

-- –¢.–µ. –≤ —Ç–µ–æ—Ä–∏–∏ —Ç–∏–ø–æ–≤ –≤–º–µ—Å—Ç–æ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤ –¥–µ–∫–∞—Ä—Ç–æ–≤—ã—Ö –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
-- –∫–∞—Ä—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π.

-- –ù–µ–º–Ω–æ–≥–æ –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–±.
-- –û–ø—Ä–µ–¥–µ–ª–∏–º —Ç–∏–ø —Ä–µ—Ñ–ª–µ–∫—Å–∏–≤–Ω—ã—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–π –Ω–∞ X:
ReflRel : ‚àÄ {‚Ñì ‚Ñì'} (X : Type ‚Ñì) ‚Üí Type _
ReflRel {‚Ñì} {‚Ñì'} X = Œ£[ R ‚àà PropRel X X ‚Ñì' ] IsRefl R

IsRefl√ó' : ‚àÄ {‚Ñì} {X : Type ‚Ñì} (R√ó : ‚Ñô (X √ó X)) ‚Üí hProp _
IsRefl√ó' {‚Ñì} {X} R√ó = (‚àÉ[ R ‚àà ReflRel {‚Ñì} {‚Ñì} X ] R√ó ‚â° uncurry (fst R)) , squash‚ÇÅ

s' : ‚àÄ {Sh : –°—Ö–µ–º–∞–°—Ç—É–ø–µ–Ω–∏ 1} ‚Üí –°—Ç—É–ø–µ–Ω—å (ùîÖ (ùîÖ (ùîá (Sh ‚à∑ Sh ‚à∑ []))))
s' = IsRefl√ó' 
  

